from subprocess import PIPE, Popen
import netifaces as ni
from django.shortcuts import render

from background_task import background


def executeCommand(command):
    print(command)
    proc = Popen(command.split(), stdout=PIPE, stderr=PIPE)
    res, err = proc.communicate()
    return res, err


def getNetworkInterfaces():
    return ni.interfaces()


def checkStatusInterface(interface):
    addr = ni.ifaddresses(interface)
    res = ni.AF_INET in addr
    return res


def dhClient(request):
    print(executeCommand('whoami'))
    addr = ni.ifaddresses(request.POST['interface'])
    res = ni.AF_INET in addr

    return render(request, 'planningConfirm.html', context={"res": res})
